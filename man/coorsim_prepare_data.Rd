% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_detect_coorsimilarity.R
\name{coorsim_prepare_data}
\alias{coorsim_prepare_data}
\title{Prepare Data for Co-Similarity Analysis}
\usage{
coorsim_prepare_data(
  data,
  embeddings = NULL,
  time_window = 60,
  post_id = NULL,
  account_id = NULL,
  time = NULL,
  content = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A `data.frame` or `data.table` containing post data. The table must include at least
`post_id`, `account_id`, `time`, and `content`, either directly or via specified alternative column names.}

\item{embeddings}{Embeddings for the posts, which can be provided in **three formats**:
\itemize{
  \item **A matrix**: Row names must correspond to `post_id` values.
  \item **A valid `.h5` file path**: The file must contain a `metadata/post_id` dataset.
  \item **NULL (default)**: No embeddings are used.
}}

\item{time_window}{Integer. The time window (in seconds) within which similar posts are detected. Default is `60`.}

\item{post_id}{Character. Alternative column name for `post_id`, if not present in `data`.}

\item{account_id}{Character. Alternative column name for `account_id`, if not present in `data`.}

\item{time}{Character. Alternative column name for `time`, if not present in `data`.}

\item{content}{Character. Alternative column name for `content`, if not present in `data`.}

\item{verbose}{Logical. If `TRUE`, displays progress messages. Default is `TRUE`.}
}
\value{
A processed `data.table` ready for correlation similarity analysis.
}
\description{
This function processes and prepares social media post data for correlation similarity analysis.
It ensures that required columns are present, standardizes time formats, and optionally integrates
embeddings either from an in-memory matrix or an `.h5` file.
}
\details{
This function performs the following preprocessing steps:
  \itemize{
    \item Ensures that `post_id`, `account_id`, `time`, and `content` exist in `data`,
          renaming alternative column names if provided.
    \item Drops duplicate posts based on `post_id`.
    \item Standardizes `time` to **Unix timestamps (UTC)** for cross-platform compatibility.
    \item Sorts posts in ascending order by `time`.
    \item If **embeddings are provided as a matrix**, retains only posts present in `rownames(embeddings)`.
    \item If **embeddings are provided as an `.h5` file**, verifies that `metadata/post_id` exists
          before extracting relevant post IDs.
  }

The function also filters out invalid time formats and ensures efficient memory usage by removing the `content` column
from the final output.
}
