% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_generate_community_labels.R
\name{sample_user_text}
\alias{sample_user_text}
\title{Sample and format posts per user for classification or labeling}
\usage{
sample_user_text(
  groups_data,
  user_vars = NULL,
  user_vars_short = NULL,
  post_vars = NULL,
  post_vars_short = NULL,
  sampling_ratio = 0.2,
  min_n = 5,
  max_n = 30,
  min_chars = 20,
  max_text_length = 500,
  clean_name = TRUE,
  seed = 42
)
}
\arguments{
\item{groups_data}{A list containing `post_data` and `node_list`, both as data.tables.}

\item{user_vars}{Character vector of user-level variables to include (besides account_name).}

\item{user_vars_short}{Optional character vector of short labels for `user_vars`, in the same order.}

\item{post_vars}{Character vector of post-level variables to include (besides content).}

\item{post_vars_short}{Optional character vector of short labels for `post_vars`, in the same order.}

\item{sampling_ratio}{Proportion of a user's posts to sample (ignored if below `min_n`).}

\item{min_n}{Minimum number of posts required per user (to include in the result).}

\item{max_n}{Maximum number of posts to sample per user.}

\item{min_chars}{Minimum number of characters required in cleaned post content.}

\item{max_text_length}{Maximum character length for any cleaned text field.}

\item{clean_name}{Logical. If TRUE, cleans the `account_name` field (recommended).}

\item{seed}{Integer seed for reproducible sampling.}
}
\value{
A data.table with one row per user, containing:
\describe{
  \item{account_id}{The user's unique account ID.}
  \item{community}{Community membership label.}
  \item{account_name_clean}{Cleaned version of the user's display name.}
  \item{text}{Markdown-formatted string with user and post metadata.}
  \item{sampled_post_ids}{List column of sampled post IDs per user.}
  \item{approx_tokens}{Approximate number of tokens in `text`.}
}
}
\description{
This function samples, cleans, and formats posts from social media users into compact
markdown-style text blocks. It includes optional user and post metadata, and estimates
token counts for use in LLM classification or labeling tasks.
}
